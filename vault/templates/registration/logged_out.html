{% extends 'vault/base.html' %}

{% block title %}Logged out — SecurePad{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
  <div class="col-md-8 col-lg-6">
    <div class="card shadow-sm text-center">
      <div class="card-body">
        <h3 class="card-title mb-3">You’ve been logged out</h3>
        <p class="mb-2">You have been logged out successfully.</p>
        <p class="small text-muted mb-3">This tab will close in <span id="countdown">5</span> seconds.</p>
        <div>
          <button id="close-try" class="btn btn-outline-primary me-2">Close now</button>
          <a class="btn btn-secondary" href="/">Return to dashboard</a>
        </div>
        <p class="mt-3 text-muted small">If the tab does not close automatically, please close it manually or return to the dashboard.</p>
      </div>
    </div>
  </div>
</div>

{% block scripts %}
{{ block.super }}
<script>
  (function () {
    var sec = 5;
    var countdownEl = document.getElementById('countdown');
    var interval = setInterval(function () {
      sec -= 1;
      countdownEl.textContent = sec;
      if (sec <= 0) {
        clearInterval(interval);
        try {
          // Attempt to close the window. May not work if not opened by script.
          window.open('', '_self'); // try to force self as target
          window.close();
        } catch (e) {
          // Noise; fallback — redirect to a page where user can close manually.
          window.location.href = '/';
        }
      }
    }, 1000);
    var btn = document.getElementById('close-try');
    btn.addEventListener('click', function () {
      try { window.open('', '_self'); window.close(); } catch (e) { window.location.href = '/'; }
    });
  })();
</script>
{% endblock %}

{% endblock %}
